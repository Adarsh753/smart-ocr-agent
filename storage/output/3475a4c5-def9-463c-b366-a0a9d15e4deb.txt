th/drive.file" # Access files in Google Driveln "https: / WWW googleapis com/auth/drive" # Full access to Google Driveln]InIndef get filtered_data(): In creds = Nonelnln # Path to the service account credentials file (use your actual path here) In service_account_file = r'D ILegal_Scanner| Master_Task| Input_data|Zegalinput . json # Update with your Service Account file pathlnln # Ensure the path is correct and the fi le existsln if 0S . path.exists(service_account_file): In print(f"Service account file found: {service_account_file}") In try: In # Load credentials from the service account JSON fileln creds = Credentials.from_service_account_file(service_account_file scopes-S ZOPE) In except Exception as e: In print(f"Error loading credentials from service account file: {str(e)}") In return Noneln else: In print(f"Service account file not found at: {service_account_file}")In return NoneInin # Use the credential 5 to interact with the Sheets APIIn try: In client = gspread.authorize(creds)In except Exception as e: In print(f"Error authorizin J with Google Sheets API: {str(e)}")In return Nonelnln # Open the spreadsheet by nameIn try: In sheet = client.open( "Legal_Scanne r_Input_Sheet_March") .sheetl # Update with your Google Sheet nameln except Exception as e: In print(f"Error opening the Google Sheet: {str (e)}") In return NoneInln # Get all data from the sheetIn try: In sheet_data = sheet.get_all_records() # Storing the data in a va riable instead of printing itln except Exception as e: In print(f"Error fetching records from Google Sheet: {str(e)}")In return None Inln # Get today' $ dateln today_date = datetime today() .date() # Use datetime.today() to get today'$ date and convert it to a date objectInin # Date format in the Google Sheet (DD-MM-YYYY) In date_format = "%d-%m-%Y"InIn # Filter the data to only include records where the date mat ches today' s dateln filtered_data = [JIn for record in sheet_data: In try: In # Convert the date from the Google Sheet to a da tetime objectIn sheet_date = datetime.strptime(str(record[ 'Date' ]) .strip() _ date_format) date()In except ValueError: In # Skip any record that has an invalid date formatIn continueln In # Compare the date in the record with today 5 dateln if sheet_date FZ today_date: In filtered_data.append(record) InIn # Now 'filtered_data contains only the records where the date mat ches today 15 dateln filtered_data_string = str(filtered_data)Inln # Return the filtered data stringIn return filtered_data_stringInin# Call the function to filtered datalnfiltered_data_result = get_filtered_data() InIn# If filtered data is not None print or return the result for Roc ketbot to uselnif filtered_data_result: In print(filtered_data_result) Inelse: In print("No data to return . ") InSetVar("filtered_data_result" filt ered_data_result) Service account file found: D: ILegal_ScannerlMaster_Taskl Input_data| legalinput. json Error loading credentials from service account file: name Credentials is not defined No data to return get